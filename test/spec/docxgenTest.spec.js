(function(){var e,t,o,a,r,l,i,d;for(l="undefined"!=typeof global&&null!==global?global:window,t="undefined"!=typeof global&&null!==global?"node":"browser",l.docX={},l.docXData={},o=require("angular-expressions"),e=function(e){var t;return t=o.compile(e),{get:t}},"node"===t&&(l.DocxGen=require(__dirname+"/../../js/docxgen.js")),DocUtils.pathConfig={browser:"../examples/"},"node"===t&&(DocUtils.pathConfig.node=__dirname+"/../../examples/"),a=["imageExample.docx","tagExample.docx","tagExampleExpected.docx","tagLoopExample.docx","tagExampleExpected.docx","tagLoopExampleImageExpected.docx","tagProduitLoop.docx","tagDashLoop.docx","tagDashLoopList.docx","tagDashLoopTable.docx","tagDashLoop.docx","qrCodeExample.docx","qrCodeExampleExpected.docx","qrCodeTaggingExample.docx","qrCodeTaggingExampleExpected.docx","qrCodeTaggingLoopExample.docx","qrCodeTaggingLoopExampleExpected.docx","tagIntelligentLoopTableExpected.docx","cyrillic.docx","tableComplex2Example.docx","tableComplexExample.docx","tableComplex3Example.docx","xmlInsertionExpected.docx","xmlInsertionExample.docx","angularExample.docx","xmlInsertionComplexExample.docx"],i=0,d=a.length;d>i;i++)r=a[i],l.docX[r]=(new DocxGen).loadFromFile(r);l.docX.tagExampleWithParser=(new DocxGen).loadFromFile("tagExample.docx"),DocUtils.loadDoc("tagIntelligentLoopTable.docx",{intelligentTagging:!0}),DocUtils.loadDoc("image.png",{docx:!1}),DocUtils.loadDoc("bootstrap_logo.png",{docx:!1}),DocUtils.loadDoc("BMW_logo.png",{docx:!1}),DocUtils.loadDoc("Firefox_logo.png",{docx:!1}),DocUtils.loadDoc("Volkswagen_logo.png",{docx:!1}),DocUtils.loadDoc("qrcodeTest.zip",{docx:!1}),describe("DocxGenBasis",function(){return it("should be defined",function(){return expect(DocxGen).not.toBe(void 0)}),it("should construct",function(){var e;return e=new DocxGen,expect(e).not.toBe(void 0)})}),describe("DocxGenLoading",function(){return describe("ajax done correctly",function(){return it("doc and img Data should have the expected length",function(){return expect(docX["imageExample.docx"].loadedContent.length).toEqual(729580),expect(docXData["image.png"].length).toEqual(18062)}),it("should have the right number of files (the docx unzipped)",function(){return docX["imageExample.docx"]=new DocxGen(docX["imageExample.docx"].loadedContent),expect(DocUtils.sizeOfObject(docX["imageExample.docx"].zip.files)).toEqual(22)})}),describe("basic loading",function(){return it("should load file imageExample.docx",function(){return expect(typeof docX["imageExample.docx"]).toBe("object")})}),describe("content_loading",function(){return it("should load the right content for the footer",function(){var e;return e=docX["imageExample.docx"].getFullText("word/footer1.xml"),expect(e.length).not.toBe(0),expect(e).toBe("{last_name}{first_name}{phone}")}),it("should load the right content for the document",function(){var e;return e=docX["imageExample.docx"].getFullText(),expect(e).toBe("")})}),describe("image loading",function(){return it("should find one image (and not more than 1)",function(){return expect(docX["imageExample.docx"].getImageList().length).toEqual(1)}),it("should find the image named with the good name",function(){return expect(docX["imageExample.docx"].getImageList()[0].path).toEqual("word/media/image1.jpeg")}),it("should change the image with another one",function(){var e,t;return t=docX["imageExample.docx"].zip.files["word/media/image1.jpeg"].asText(),docX["imageExample.docx"].setImage("word/media/image1.jpeg",docXData["image.png"],{binary:!1}),e=docX["imageExample.docx"].zip.files["word/media/image1.jpeg"].asText(),expect(t).not.toEqual(e),expect(docXData["image.png"]).toEqual(e)})}),describe("output and input",function(){return it("should be the same",function(){var e,t;return e=new DocxGen(l.docX["tagExample.docx"].loadedContent),t=e.output(!1),expect(t.length).toEqual(91348),expect(t.substr(0,50)).toEqual("UEsDBAoAAAAAAAAAIQAMTxYSlgcAAJYHAAATAAAAW0NvbnRlbn")})})}),describe("DocxGenTemplating",function(){return describe("text templating",function(){return it("should change values with template vars",function(){var e;return e={first_name:"Hipp",last_name:"Edgar",phone:"0652455478",description:"New Website"},docX["tagExample.docx"].setTags(e),docX["tagExample.docx"].applyTags(),expect(docX["tagExample.docx"].getFullText()).toEqual("Edgar Hipp"),expect(docX["tagExample.docx"].getFullText("word/header1.xml")).toEqual("Edgar Hipp0652455478New Website"),expect(docX["tagExample.docx"].getFullText("word/footer1.xml")).toEqual("EdgarHipp0652455478")}),it("should export the good file",function(){var e,t;t=[];for(e in docX["tagExample.docx"].zip.files)expect(docX["tagExample.docx"].zip.files[e].options.date).not.toBe(docX["tagExampleExpected.docx"].zip.files[e].options.date),expect(docX["tagExample.docx"].zip.files[e].name).toBe(docX["tagExampleExpected.docx"].zip.files[e].name),expect(docX["tagExample.docx"].zip.files[e].options.dir).toBe(docX["tagExampleExpected.docx"].zip.files[e].options.dir),t.push(expect(docX["tagExample.docx"].zip.files[e].asText()).toBe(docX["tagExampleExpected.docx"].zip.files[e].asText()));return t})})}),describe("DocxGenTemplatingForLoop",function(){return describe("textLoop templating",function(){return it("should replace all the tags",function(){var e;return e={nom:"Hipp",prenom:"Edgar",telephone:"0652455478",description:"New Website",offre:[{titre:"titre1",prix:"1250"},{titre:"titre2",prix:"2000"},{titre:"titre3",prix:"1400"}]},docX["tagLoopExample.docx"].setTags(e),docX["tagLoopExample.docx"].applyTags(),expect(docX["tagLoopExample.docx"].getFullText()).toEqual("Votre proposition commercialePrix: 1250Titre titre1Prix: 2000Titre titre2Prix: 1400Titre titre3HippEdgar")}),it("should work with loops inside loops",function(){var e,t,o;return e={products:[{title:"Microsoft",name:"DOS",reference:"Win7",avantages:[{title:"Everyone uses it",proof:[{reason:"it is quite cheap"},{reason:"it is quit simple"},{reason:"it works on a lot of different Hardware"}]}]},{title:"Linux",name:"Ubuntu",reference:"Ubuntu10",avantages:[{title:"It's very powerful",proof:[{reason:"the terminal is your friend"},{reason:"Hello world"},{reason:"it's free"}]}]},{title:"Apple",name:"Mac",reference:"OSX",avantages:[{title:"It's very easy",proof:[{reason:"you can do a lot just with the mouse"},{reason:"It's nicely designed"}]}]}]},docX["tagProduitLoop.docx"].setTags(e),docX["tagProduitLoop.docx"].applyTags(),o=docX["tagProduitLoop.docx"].getFullText(),t="MicrosoftProduct name : DOSProduct reference : Win7Everyone uses itProof that it works nicely : It works because it is quite cheap It works because it is quit simple It works because it works on a lot of different HardwareLinuxProduct name : UbuntuProduct reference : Ubuntu10It's very powerfulProof that it works nicely : It works because the terminal is your friend It works because Hello world It works because it's freeAppleProduct name : MacProduct reference : OSXIt's very easyProof that it works nicely : It works because you can do a lot just with the mouse It works because It's nicely designed",expect(o.length).toEqual(t.length),expect(o).toEqual(t)})})}),describe("Xml Util",function(){var e;return e=new XmlUtil,it("should compute the scope between 2 <w:t>",function(){var t;return t=e.getListXmlElements('undefined</w:t></w:r></w:p><w:p w:rsidP="008A4B3C" w:rsidR="007929C1" w:rsidRDefault="007929C1" w:rsidRPr="008A4B3C"><w:pPr><w:pStyle w:val="Sous-titre"/></w:pPr><w:r w:rsidRPr="008A4B3C"><w:t xml:space="preserve">Audit réalisé le '),expect(t).toEqual([{tag:"</w:t>",offset:9},{tag:"</w:r>",offset:15},{tag:"</w:p>",offset:21},{tag:"<w:p>",offset:27},{tag:"<w:r>",offset:162},{tag:"<w:t>",offset:188}])}),it("should compute the scope between 2 <w:t> in an Array",function(){var t;return t=e.getListXmlElements('urs</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:type="dxa" w:w="4140"/></w:tcPr><w:p w:rsidP="00CE524B" w:rsidR="00CE524B" w:rsidRDefault="00CE524B"><w:pPr><w:rPr><w:rFonts w:ascii="Times New Roman" w:hAnsi="Times New Roman"/><w:color w:val="auto"/></w:rPr></w:pPr><w:r><w:rPr><w:rFonts w:ascii="Times New Roman" w:hAnsi="Times New Roman"/><w:color w:val="auto"/></w:rPr><w:t>Sur exté'),expect(t).toEqual([{tag:"</w:t>",offset:3},{tag:"</w:r>",offset:9},{tag:"</w:p>",offset:15},{tag:"</w:tc>",offset:21},{tag:"<w:tc>",offset:28},{tag:"<w:p>",offset:83},{tag:"<w:r>",offset:268},{tag:"<w:t>",offset:374}])}),it("should compute the scope between a w:t in an array and the other outside",function(){var t;return t=e.getListXmlElements('defined </w:t></w:r></w:p></w:tc></w:tr></w:tbl><w:p w:rsidP="00CA7135" w:rsidR="00BE3585" w:rsidRDefault="00BE3585"/><w:p w:rsidP="00CA7135" w:rsidR="00BE3585" w:rsidRDefault="00BE3585"/><w:p w:rsidP="00CA7135" w:rsidR="00137C91" w:rsidRDefault="00137C91"><w:r w:rsidRPr="00B12C70"><w:rPr><w:bCs/></w:rPr><w:t>Coût ressources '),expect(t).toEqual([{tag:"</w:t>",offset:8},{tag:"</w:r>",offset:14},{tag:"</w:p>",offset:20},{tag:"</w:tc>",offset:26},{tag:"</w:tr>",offset:33},{tag:"</w:tbl>",offset:40},{tag:"<w:p>",offset:188},{tag:"<w:r>",offset:257},{tag:"<w:t>",offset:306}])})}),describe("scope diff calculation",function(){var e;return e=new XmlUtil,it("should compute the scopeDiff between 2 <w:t>",function(){var t;return t=e.getListDifferenceXmlElements('undefined</w:t></w:r></w:p><w:p w:rsidP="008A4B3C" w:rsidR="007929C1" w:rsidRDefault="007929C1" w:rsidRPr="008A4B3C"><w:pPr><w:pStyle w:val="Sous-titre"/></w:pPr><w:r w:rsidRPr="008A4B3C"><w:t xml:space="preserve">Audit réalisé le '),expect(t).toEqual([])}),it("should compute the scopeDiff between 2 <w:t> in an Array",function(){var t;return t=e.getListDifferenceXmlElements('urs</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:type="dxa" w:w="4140"/></w:tcPr><w:p w:rsidP="00CE524B" w:rsidR="00CE524B" w:rsidRDefault="00CE524B"><w:pPr><w:rPr><w:rFonts w:ascii="Times New Roman" w:hAnsi="Times New Roman"/><w:color w:val="auto"/></w:rPr></w:pPr><w:r><w:rPr><w:rFonts w:ascii="Times New Roman" w:hAnsi="Times New Roman"/><w:color w:val="auto"/></w:rPr><w:t>Sur exté'),expect(t).toEqual([])}),it("should compute the scopeDiff between a w:t in an array and the other outside",function(){var t;return t=e.getListDifferenceXmlElements('defined </w:t></w:r></w:p></w:tc></w:tr></w:tbl><w:p w:rsidP="00CA7135" w:rsidR="00BE3585" w:rsidRDefault="00BE3585"/><w:p w:rsidP="00CA7135" w:rsidR="00BE3585" w:rsidRDefault="00BE3585"/><w:p w:rsidP="00CA7135" w:rsidR="00137C91" w:rsidRDefault="00137C91"><w:r w:rsidRPr="00B12C70"><w:rPr><w:bCs/></w:rPr><w:t>Coût ressources '),expect(t).toEqual([{tag:"</w:tc>",offset:26},{tag:"</w:tr>",offset:33},{tag:"</w:tbl>",offset:40}])})}),describe("scope inner text",function(){return it("should find the scope",function(){var e,t,o;return o=new DocXTemplater,docX["tagProduitLoop.docx"].load(docX["tagProduitLoop.docx"].loadedContent),t=o.getOuterXml(docX["tagProduitLoop.docx"].zip.files["word/document.xml"].asText(),1195,1245,"w:p"),e={text:'<w:p w:rsidR="00923B77" w:rsidRDefault="00923B77"><w:r><w:t>{#</w:t></w:r><w:r w:rsidR="00713414"><w:t>products</w:t></w:r><w:r><w:t>}</w:t></w:r></w:p>',startTag:1134,endTag:1286},expect(t.endTag).toEqual(e.endTag),expect(t.startTag).toEqual(e.startTag),expect(t.text.length).toEqual(e.text.length),expect(t.text).toEqual(e.text)})}),describe("Dash Loop Testing",function(){return it("dash loop ok on simple table -> w:tr",function(){var e,t,o;return e={os:[{type:"linux",price:"0",reference:"Ubuntu10"},{type:"DOS",price:"500",reference:"Win7"},{type:"apple",price:"1200",reference:"MACOSX"}]},docX["tagDashLoop.docx"].setTags(e),docX["tagDashLoop.docx"].applyTags(),t="linux0Ubuntu10DOS500Win7apple1200MACOSX",o=docX["tagDashLoop.docx"].getFullText(),expect(o).toBe(t)}),it("dash loop ok on simple table -> w:table",function(){var e,t,o;return e={os:[{type:"linux",price:"0",reference:"Ubuntu10"},{type:"DOS",price:"500",reference:"Win7"},{type:"apple",price:"1200",reference:"MACOSX"}]},docX["tagDashLoopTable.docx"].setTags(e),docX["tagDashLoopTable.docx"].applyTags(),t="linux0Ubuntu10DOS500Win7apple1200MACOSX",o=docX["tagDashLoopTable.docx"].getFullText(),expect(o).toBe(t)}),it("dash loop ok on simple list -> w:p",function(){var e,t,o;return e={os:[{type:"linux",price:"0",reference:"Ubuntu10"},{type:"DOS",price:"500",reference:"Win7"},{type:"apple",price:"1200",reference:"MACOSX"}]},docX["tagDashLoopList.docx"].setTags(e),docX["tagDashLoopList.docx"].applyTags(),t="linux 0 Ubuntu10 DOS 500 Win7 apple 1200 MACOSX ",o=docX["tagDashLoopList.docx"].getFullText(),expect(o).toBe(t)})}),describe("Intelligent Loop Tagging",function(){return it("should work with tables",function(){var e,t,o,a,r;e={clients:[{first_name:"John",last_name:"Doe",phone:"+33647874513"},{first_name:"Jane",last_name:"Doe",phone:"+33454540124"},{first_name:"Phil",last_name:"Kiel",phone:"+44578451245"},{first_name:"Dave",last_name:"Sto",phone:"+44548787984"}]},docX["tagIntelligentLoopTable.docx"].setTags(e),docX["tagIntelligentLoopTable.docx"].applyTags(),t="JohnDoe+33647874513JaneDoe+33454540124PhilKiel+44578451245DaveSto+44548787984",a=docX["tagIntelligentLoopTableExpected.docx"].getFullText(),expect(a).toBe(t),r=[];for(o in docX["tagIntelligentLoopTable.docx"].zip.files)expect(docX["tagIntelligentLoopTable.docx"].zip.files[o].asText()).toBe(docX["tagIntelligentLoopTableExpected.docx"].zip.files[o].asText()),expect(docX["tagIntelligentLoopTable.docx"].zip.files[o].name).toBe(docX["tagIntelligentLoopTableExpected.docx"].zip.files[o].name),expect(docX["tagIntelligentLoopTable.docx"].zip.files[o].options.dir).toBe(docX["tagIntelligentLoopTableExpected.docx"].zip.files[o].options.dir),r.push(expect(docX["tagIntelligentLoopTable.docx"].zip.files[o].options.date).not.toBe(docX["tagIntelligentLoopTableExpected.docx"].zip.files[o].options.date));return r})}),describe("getTags",function(){return it("should work with simple document",function(){var e;return docX["tagExample.docx"]=new DocxGen(docX["tagExample.docx"].loadedContent,{},{intelligentTagging:!1}),e=docX["tagExample.docx"].getTags(),expect(e).toEqual([{fileName:"word/document.xml",vars:{last_name:!0,first_name:!0}},{fileName:"word/footer1.xml",vars:{last_name:!0,first_name:!0,phone:!0}},{fileName:"word/header1.xml",vars:{last_name:!0,first_name:!0,phone:!0,description:!0}}])}),it("should work with loop document",function(){var e;return docX["tagLoopExample.docx"]=new DocxGen(docX["tagLoopExample.docx"].loadedContent,{},{intelligentTagging:!1}),e=docX["tagLoopExample.docx"].getTags(),expect(e).toEqual([{fileName:"word/document.xml",vars:{offre:{prix:!0,titre:!0},nom:!0,prenom:!0}},{fileName:"word/footer1.xml",vars:{nom:!0,prenom:!0,telephone:!0}},{fileName:"word/header1.xml",vars:{nom:!0,prenom:!0}}])}),it("should work if there are no Tags",function(){var e;return docX["qrCodeExample.docx"]=new DocxGen(docX["qrCodeExample.docx"].loadedContent,{},{intelligentTagging:!1}),e=docX["qrCodeExample.docx"].getTags(),expect(e).toEqual([])})}),describe("xmlTemplater",function(){return it("should work with simpleContent",function(){var e,t,o;return e="<w:t>Hello {name}</w:t>",t={name:"Edgar"},o=new DocXTemplater(e,{Tags:t}),o.applyTags(),expect(o.getFullText()).toBe("Hello Edgar")}),it("should work with non w:t content",function(){var e,t,o;return e="{image}.png",t={image:"edgar"},o=new DocXTemplater(e,{Tags:t}),o.applyTags(),expect(o.content).toBe("edgar.png")}),it("should work with tag in two elements",function(){var e,t,o;return e="<w:t>Hello {</w:t><w:t>name}</w:t>",t={name:"Edgar"},o=new DocXTemplater(e,{Tags:t}),o.applyTags(),expect(o.getFullText()).toBe("Hello Edgar")}),it("should work with simple Loop",function(){var e,t,o;return e="<w:t>Hello {#names}{name},{/names}</w:t>",t={names:[{name:"Edgar"},{name:"Mary"},{name:"John"}]},o=new DocXTemplater(e,{Tags:t}),o.applyTags(),expect(o.getFullText()).toBe("Hello Edgar,Mary,John,")}),it("should work with simple Loop with boolean value",function(){var e,t,o;return e="<w:t>Hello {#showName}{name},{/showName}</w:t>",t={showName:!0,name:"Edgar"},o=new DocXTemplater(e,{Tags:t}),o.applyTags(),expect(o.getFullText()).toBe("Hello Edgar,"),t={showName:!1,name:"Edgar"},o=new DocXTemplater(e,{Tags:t}),o.applyTags(),expect(o.getFullText()).toBe("Hello ")}),it("should work with dash Loop",function(){var e,t,o;return e="<w:p><w:t>Hello {-w:p names}{name},{/names}</w:t></w:p>",t={names:[{name:"Edgar"},{name:"Mary"},{name:"John"}]},o=new DocXTemplater(e,{Tags:t}),o.applyTags(),expect(o.getFullText()).toBe("Hello Edgar,Hello Mary,Hello John,")}),it("should work with loop and innerContent",function(){var e,t,o;return e='</w:t></w:r></w:p><w:p w:rsidR="00923B77" w:rsidRDefault="00713414" w:rsidP="00923B77"><w:pPr><w:pStyle w:val="Titre1"/></w:pPr><w:r><w:t>{title</w:t></w:r><w:r w:rsidR="00923B77"><w:t>}</w:t></w:r></w:p><w:p w:rsidR="00923B77" w:rsidRPr="00923B77" w:rsidRDefault="00713414" w:rsidP="00923B77"><w:r><w:t>Proof that it works nicely :</w:t></w:r></w:p><w:p w:rsidR="00923B77" w:rsidRDefault="00923B77" w:rsidP="00923B77"><w:pPr><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>{#pr</w:t></w:r><w:r w:rsidR="00713414"><w:t>oof</w:t></w:r><w:r><w:t xml:space="preserve">} </w:t></w:r><w:r w:rsidR="00713414"><w:t>It works because</w:t></w:r><w:r><w:t xml:space="preserve"> {</w:t></w:r><w:r w:rsidR="006F26AC"><w:t>reason</w:t></w:r><w:r><w:t>}</w:t></w:r></w:p><w:p w:rsidR="00923B77" w:rsidRDefault="00713414" w:rsidP="00923B77"><w:pPr><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>{/proof</w:t></w:r><w:r w:rsidR="00923B77"><w:t>}</w:t></w:r></w:p><w:p w:rsidR="00FD04E9" w:rsidRDefault="00923B77"><w:r><w:t>',t={title:"Everyone uses it",proof:[{reason:"it is quite cheap"},{reason:"it is quit simple"},{reason:"it works on a lot of different Hardware"}]},o=new DocXTemplater(e,{Tags:t}),o.applyTags(),expect(o.getFullText()).toBe("Everyone uses itProof that it works nicely : It works because it is quite cheap It works because it is quit simple It works because it works on a lot of different Hardware")}),it("should work with loop and innerContent (with last)",function(){var e,t,o;return e='Start </w:t></w:r></w:p><w:p w:rsidR="00923B77" w:rsidRDefault="00713414" w:rsidP="00923B77"><w:pPr><w:pStyle w:val="Titre1"/></w:pPr><w:r><w:t>{title</w:t></w:r><w:r w:rsidR="00923B77"><w:t>}</w:t></w:r></w:p><w:p w:rsidR="00923B77" w:rsidRPr="00923B77" w:rsidRDefault="00713414" w:rsidP="00923B77"><w:r><w:t>Proof that it works nicely :</w:t></w:r></w:p><w:p w:rsidR="00923B77" w:rsidRDefault="00923B77" w:rsidP="00923B77"><w:pPr><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>{#pr</w:t></w:r><w:r w:rsidR="00713414"><w:t>oof</w:t></w:r><w:r><w:t xml:space="preserve">} </w:t></w:r><w:r w:rsidR="00713414"><w:t>It works because</w:t></w:r><w:r><w:t xml:space="preserve"> {</w:t></w:r><w:r w:rsidR="006F26AC"><w:t>reason</w:t></w:r><w:r><w:t>}</w:t></w:r></w:p><w:p w:rsidR="00923B77" w:rsidRDefault="00713414" w:rsidP="00923B77"><w:pPr><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>{/proof</w:t></w:r><w:r w:rsidR="00923B77"><w:t>}</w:t></w:r></w:p><w:p w:rsidR="00FD04E9" w:rsidRDefault="00923B77"><w:r><w:t> End',t={title:"Everyone uses it",proof:[{reason:"it is quite cheap"},{reason:"it is quit simple"},{reason:"it works on a lot of different Hardware"}]},o=new DocXTemplater(e,{Tags:t}),o.applyTags(),expect(o.getFullText()).toBe("Start Everyone uses itProof that it works nicely : It works because it is quite cheap It works because it is quit simple It works because it works on a lot of different Hardware End")}),it("should work with not w:t tag (if the for loop is like {#forloop} text {/forloop}) ",function(){var e,t,o;return e="Hello {#names}{name},{/names}",t={names:[{name:"Edgar"},{name:"Mary"},{name:"John"}]},o=new DocXTemplater(e,{Tags:t}),o.applyTags(),expect(o.content).toBe("Hello Edgar,Mary,John,")})}),describe("DocxQrCode module",function(){return describe("Calculate simple Docx",function(){var e,o,a,r;return e=null,o=null,r=null,a=null,beforeEach(function(){var e;return r=new JSZip(docXData["qrcodeTest.zip"]),e=new DocxGen,a=new DocXTemplater("",{DocxGen:e,Tags:{Tag:"tagValue"}})}),it("should do it's thing with JSZip.base64",function(){var e,t;return t=r.files["blabla.png"].asText(),e=JSZip.base64.encode(t),expect(e.length).toBe(624),expect(e.substr(0,50)).toBe("kcNChoKAAAADUlIRFIAAAAAIAAABOAAAAAZ0Uk5TAEAA07AAAE"),expect(e).toBe("kcNChoKAAAADUlIRFIAAAAAIAAABOAAAAAZ0Uk5TAEAA07AAAEURBVHdQkUQ/RQDIg7ON9jXTF4flff17B0EYJEDoJQidBDPcfG30PMH+N1VJTkQOglCJ0Icn0rPTxJEDoJQidB0Egj89PenQhBCVg2Rk9c5RA6CUInQhBOPm8gdBCRA6CUInQfN3dBB0EYJEDoJQidheKSkkC0EYJEDoJs9P141dBB0EYJEDoJQidhm2fVzZlnQhBCRuRTcye633fQSkQOglCJ0IXX6KdHB0WEDoJQidB0Ec/dX/teYY/Tyc6CUInQhBCcv/Xic6CUInQhBCm/f+FP0EYJEDoJQidB9Fnvc1hBCRA6CWve0IQSkYWk3HuPcB0EYJEDoJQidBUcez9HP3fPE0EYJEDoJQidhOEc/p53vf6/PcB0EYJEDoJQidBHfhd8VPWfP59dBJEDoJQidBsH31kpVfkQOglCJ0I0fl1axBA6CUInQhBjn/mHdidB0EJwHPOXVPiAhBCRA6Cf3Xc/8n0EJ0IQSlYNkzedHd+Nfx9xHQSkQOglCJ08+H9QSRA6CUInQh+pnQhBCd/fUcMRdCJ0IQSnAfHhBCRA6CUIn0wsvkAAAAASUVORA")}),it("should work with Blablalalabioeajbiojbepbroji",function(){return runs(function(){var l,i,d,w,n,c;return o=!1,e={test:function(){return o=!0}},spyOn(e,"test").andCallThrough(),"browser"===t?(c=new DocxQrCode(r.files["blabla.png"].asBinary(),a,"custom.png",6),c.decode(e.test)):(l=JSZip.base64.encode(r.files["blabla.png"].asBinary()),i=new Buffer(l,"base64"),n=new PNG(i),w=function(t){return n.decoded=t,c=new DocxQrCode(n,a,"custom.png",6),c.decode(e.test)},d=n.decode(w))}),waitsFor(function(){return o}),runs(function(){return expect(e.test).toHaveBeenCalled(),expect(e.test.calls.length).toEqual(1),expect(e.test.mostRecentCall.args[0].result).toEqual("Blablalalabioeajbiojbepbroji"),expect(e.test.mostRecentCall.args[1]).toEqual("custom.png"),expect(e.test.mostRecentCall.args[2]).toEqual(6)})}),it("should work with long texts",function(){return runs(function(){var l,i,d,w,n,c;return o=!1,e={test:function(){return o=!0}},spyOn(e,"test").andCallThrough(),"browser"===t?(c=new DocxQrCode(r.files["custom.png"].asBinary(),a,"custom.png",6),c.decode(e.test)):(l=JSZip.base64.encode(r.files["custom.png"].asBinary()),i=new Buffer(l,"base64"),n=new PNG(i),w=function(t){return n.decoded=t,c=new DocxQrCode(n,a,"custom.png",6),c.decode(e.test)},d=n.decode(w))}),waitsFor(function(){return o}),runs(function(){return expect(e.test).toHaveBeenCalled(),expect(e.test.calls.length).toEqual(1),expect(e.test.mostRecentCall.args[0].result).toEqual("Some custom text"),expect(e.test.mostRecentCall.args[1]).toEqual("custom.png"),expect(e.test.mostRecentCall.args[2]).toEqual(6)})}),it("should work with basic image",function(){return runs(function(){var l,i,d,w,n,c;return o=!1,e={test:function(){return o=!0}},spyOn(e,"test").andCallThrough(),"browser"===t?(c=new DocxQrCode(r.files["qrcodeTest.png"].asBinary(),a,"qrcodeTest.png",4),c.decode(e.test)):(l=JSZip.base64.encode(r.files["qrcodeTest.png"].asBinary()),i=new Buffer(l,"base64"),n=new PNG(i),w=function(t){return n.decoded=t,c=new DocxQrCode(n,a,"qrcodeTest.png",4),c.decode(e.test)},d=n.decode(w))}),waitsFor(function(){return o}),runs(function(){return expect(e.test).toHaveBeenCalled(),expect(e.test.calls.length).toEqual(1),expect(e.test.mostRecentCall.args[0].result).toEqual("test"),expect(e.test.mostRecentCall.args[1]).toEqual("qrcodeTest.png"),expect(e.test.mostRecentCall.args[2]).toEqual(4)})}),it("should work with image with {tags}",function(){return runs(function(){var l,i,d,w,n,c;return o=!1,e={test:function(){return o=!0}},spyOn(e,"test").andCallThrough(),"browser"===t?(c=new DocxQrCode(r.files["qrcodetag.png"].asBinary(),a,"tag.png",2),c.decode(e.test)):(l=JSZip.base64.encode(r.files["qrcodetag.png"].asBinary()),i=new Buffer(l,"base64"),n=new PNG(i),w=function(t){return n.decoded=t,c=new DocxQrCode(n,a,"tag.png",2),c.decode(e.test)},d=n.decode(w))}),waitsFor(function(){return o}),runs(function(){return expect(e.test).toHaveBeenCalled(),expect(e.test.calls.length).toEqual(1),expect(e.test.mostRecentCall.args[0].result).toEqual("tagValue"),expect(e.test.mostRecentCall.args[1]).toEqual("tag.png"),expect(e.test.mostRecentCall.args[2]).toEqual(2)})})})}),describe("image Loop Replacing",function(){return describe("rels",function(){return it("should load",function(){return expect(docX["imageExample.docx"].imgManager.loadImageRels().imageRels).toEqual([]),expect(docX["imageExample.docx"].imgManager.maxRid).toEqual(10)}),it("should add",function(){var e,t,o,a,r,l,i;return a=docX["imageExample.docx"].zip.files["word/_rels/document.xml.rels"].asText(),expect(docX["imageExample.docx"].imgManager.addImageRels("image1.png",docXData["bootstrap_logo.png"])).toBe(11),expect(docX["imageExample.docx"].zip.files["word/_rels/document.xml.rels"].asText()).not.toBe(a),l=docX["imageExample.docx"].zip.files["word/_rels/document.xml.rels"].asText(),e=docX["imageExample.docx"].zip.files["[Content_Types].xml"].asText(),i=DocUtils.Str2xml(l),t=DocUtils.Str2xml(e),r=i.getElementsByTagName("Relationship"),o=t.getElementsByTagName("Default"),expect(r.length).toEqual(11),expect(o.length).toBe(4)})})}),describe("loop forTagging images",function(){return it("should work with a simple loop file",function(){var e,o,a,r,l,i,d,w,n;docX["tagLoopExample.docx"]=new DocxGen(docX["tagLoopExample.docx"].loadedContent),w={nom:"Hipp",prenom:"Edgar",telephone:"0652455478",description:"New Website",offre:[{titre:"titre1",prix:"1250",img:[{data:docXData["Volkswagen_logo.png"],name:"vw_logo.png"}]},{titre:"titre2",prix:"2000",img:[{data:docXData["BMW_logo.png"],name:"bmw_logo.png"}]},{titre:"titre3",prix:"1400",img:[{data:docXData["Firefox_logo.png"],name:"firefox_logo.png"}]}]},docX["tagLoopExample.docx"].setTags(w),docX["tagLoopExample.docx"].applyTags();for(r in docX["tagLoopExample.docx"].zip.files)expect(docX["tagLoopExample.docx"].zip.files[r].options.date).not.toBe(docX["tagLoopExampleImageExpected.docx"].zip.files[r].options.date),expect(docX["tagLoopExample.docx"].zip.files[r].name).toBe(docX["tagLoopExampleImageExpected.docx"].zip.files[r].name),expect(docX["tagLoopExample.docx"].zip.files[r].options.dir).toBe(docX["tagLoopExampleImageExpected.docx"].zip.files[r].options.dir),"word/_rels/document.xml.rels"!==r&&"[Content_Types].xml"!==r&&("browser"===t||"word/document.xml"!==r)&&(("function"==typeof(n=docX["tagLoopExample.docx"].zip.files[r].asText())?n(0):void 0)&&expect(docX["tagLoopExample.docx"].zip.files[r].asText().length).toBe(docX["tagLoopExampleImageExpected.docx"].zip.files[r].asText().length),expect(docX["tagLoopExample.docx"].zip.files[r].asText()).toBe(docX["tagLoopExampleImageExpected.docx"].zip.files[r].asText()));return i=docX["tagLoopExample.docx"].zip.files["word/_rels/document.xml.rels"].asText(),e=docX["tagLoopExample.docx"].zip.files["[Content_Types].xml"].asText(),d=DocUtils.Str2xml(i),o=DocUtils.Str2xml(e),l=d.getElementsByTagName("Relationship"),a=o.getElementsByTagName("Default"),expect(l.length).toEqual(16),expect(a.length).toBe(3)})}),describe("qr code testing",function(){return it("should work with local QRCODE without tags",function(){var e;return docX["qrCodeExample.docx"]=new DocxGen(docX["qrCodeExample.docx"].loadedContent,{},{intelligentTagging:!1,qrCode:!0}),e=function(){return 1},docX["qrCodeExample.docx"].applyTags({},e),waitsFor(function(){return null!=docX["qrCodeExample.docx"].ready}),runs(function(){var e,t;expect(null!=docX["qrCodeExample.docx"].zip.files["word/media/Copie_0.png"]).toBeTruthy(),t=[];for(e in docX["qrCodeExample.docx"].zip.files)expect(docX["qrCodeExample.docx"].zip.files[e].options.date).not.toBe(docX["qrCodeExampleExpected.docx"].zip.files[e].options.date),expect(docX["qrCodeExample.docx"].zip.files[e].name).toBe(docX["qrCodeExampleExpected.docx"].zip.files[e].name),t.push(expect(docX["qrCodeExample.docx"].zip.files[e].options.dir).toBe(docX["qrCodeExampleExpected.docx"].zip.files[e].options.dir));return t})}),it("should work with local QRCODE with {tags}",function(){var e;return docX["qrCodeTaggingExample.docx"]=new DocxGen(docX["qrCodeTaggingExample.docx"].loadedContent,{image:"Firefox_logo"},{intelligentTagging:!1,qrCode:!0}),e=function(){return 1},docX["qrCodeTaggingExample.docx"].applyTags({image:"Firefox_logo"},e),waitsFor(function(){return null!=docX["qrCodeTaggingExample.docx"].ready}),runs(function(){var e,t;expect(null!=docX["qrCodeTaggingExample.docx"].zip.files["word/media/Copie_0.png"]).toBeTruthy(),t=[];for(e in docX["qrCodeTaggingExample.docx"].zip.files)expect(docX["qrCodeTaggingExample.docx"].zip.files[e].options.date).not.toBe(docX["qrCodeTaggingExampleExpected.docx"].zip.files[e].options.date),expect(docX["qrCodeTaggingExample.docx"].zip.files[e].name).toBe(docX["qrCodeTaggingExampleExpected.docx"].zip.files[e].name),expect(docX["qrCodeTaggingExample.docx"].zip.files[e].options.dir).toBe(docX["qrCodeTaggingExampleExpected.docx"].zip.files[e].options.dir),null!==docX["qrCodeTaggingExample.docx"].zip.files[e].asText()&&"word/document.xml"!==e?(expect(docX["qrCodeTaggingExample.docx"].zip.files[e].asText().length).toBe(docX["qrCodeTaggingExampleExpected.docx"].zip.files[e].asText().length),t.push(expect(docX["qrCodeExample.docx"].zip.files[e].asText()).toBe(docX["qrCodeExampleExpected.docx"].zip.files[e].asText()))):t.push(void 0);return t})}),it("should work with loop QRCODE with {tags}",function(){var e;return docX["qrCodeTaggingLoopExample.docx"]=new DocxGen(docX["qrCodeTaggingLoopExample.docx"].loadedContent,{},{intelligentTagging:!1,qrCode:!0}),e=function(){return 1},docX["qrCodeTaggingLoopExample.docx"].applyTags({images:[{image:"Firefox_logo"},{image:"image"}]},e),docX["qrCodeTaggingLoopExample.docx"],waitsFor(function(){return null!=docX["qrCodeTaggingLoopExample.docx"].ready}),runs(function(){var e,t;expect(null!=docX["qrCodeTaggingLoopExample.docx"].zip.files["word/media/Copie_0.png"]).toBeTruthy(),expect(null!=docX["qrCodeTaggingLoopExample.docx"].zip.files["word/media/Copie_1.png"]).toBeTruthy(),expect(null!=docX["qrCodeTaggingLoopExample.docx"].zip.files["word/media/Copie_2.png"]).toBeFalsy(),t=[];for(e in docX["qrCodeTaggingLoopExample.docx"].zip.files)expect(docX["qrCodeTaggingLoopExample.docx"].zip.files[e].options.date).not.toBe(docX["qrCodeTaggingLoopExampleExpected.docx"].zip.files[e].options.date),expect(docX["qrCodeTaggingLoopExample.docx"].zip.files[e].name).toBe(docX["qrCodeTaggingLoopExampleExpected.docx"].zip.files[e].name),t.push(expect(docX["qrCodeTaggingLoopExample.docx"].zip.files[e].options.dir).toBe(docX["qrCodeTaggingLoopExampleExpected.docx"].zip.files[e].options.dir));return t})})}),describe("Changing the parser",function(){return it("should work with uppercassing",function(){var e,t,o,a;return e="<w:t>Hello {name}</w:t>",o={name:"Edgar"},t=function(e){return{get:function(t){return t[e].toUpperCase()}}},a=new DocXTemplater(e,{Tags:o,parser:t}),a.applyTags(),expect(a.getFullText()).toBe("Hello EDGAR")}),it("should work when setting from the DocXGen interface",function(){var e;return e={first_name:"Hipp",last_name:"Edgar",phone:"0652455478",description:"New Website"},docX.tagExampleWithParser.setTags(e),docX.tagExampleWithParser.parser=function(e){return{get:function(t){return t[e].toUpperCase()}}},docX.tagExampleWithParser.applyTags(),expect(docX.tagExampleWithParser.getFullText()).toEqual("EDGAR HIPP"),expect(docX.tagExampleWithParser.getFullText("word/header1.xml")).toEqual("EDGAR HIPP0652455478NEW WEBSITE"),expect(docX.tagExampleWithParser.getFullText("word/footer1.xml")).toEqual("EDGARHIPP0652455478")}),it("should work with angular parser",function(){var t;return t={person:{first_name:"Hipp",last_name:"Edgar",birth_year:1955,age:59}},docX["angularExample.docx"].setTags(t),docX["angularExample.docx"].parser=e,docX["angularExample.docx"].applyTags(),expect(docX["angularExample.docx"].getFullText()).toEqual("Hipp Edgar 2014")})}),describe("Non Utf-8 characters",function(){return it("should read full text correctly",function(){var e;
return e=docX["cyrillic.docx"].getFullText(),expect(e.charCodeAt(0)).toBe(1024),expect(e.charCodeAt(1)).toBe(1050),expect(e.charCodeAt(2)).toBe(1048),expect(e.charCodeAt(3)).toBe(1046),expect(e.charCodeAt(4)).toBe(1044),expect(e.charCodeAt(5)).toBe(1045),expect(e.charCodeAt(6)).toBe(1039),expect(e.charCodeAt(7)).toBe(1040)}),it("should still read full text after applying tags",function(){var e;return docX["cyrillic.docx"].applyTags({name:"Edgar"}),e=docX["cyrillic.docx"].getFullText(),expect(e.charCodeAt(0)).toBe(1024),expect(e.charCodeAt(1)).toBe(1050),expect(e.charCodeAt(2)).toBe(1048),expect(e.charCodeAt(3)).toBe(1046),expect(e.charCodeAt(4)).toBe(1044),expect(e.charCodeAt(5)).toBe(1045),expect(e.charCodeAt(6)).toBe(1039),expect(e.charCodeAt(7)).toBe(1040),expect(e.indexOf("Edgar")).toBe(9)}),it("should insert russian characters",function(){var e,t,o,a;return a=[1055,1091,1087,1082,1080,1085,1072],o=function(){var t,o,r;for(r=[],t=0,o=a.length;o>t;t++)e=a[t],r.push(String.fromCharCode(e));return r}(),o=o.join(""),docX["tagExample.docx"].applyTags({last_name:o}),t=docX["tagExample.docx"].getFullText(),expect(t.substr(0,7)).toBe(o)})}),describe("Complex table example",function(){return it("should work with simple table",function(){var e;return docX["tableComplex2Example.docx"].setTags({table1:[{t1data1:"t1-1row-data1",t1data2:"t1-1row-data2",t1data3:"t1-1row-data3",t1data4:"t1-1row-data4"},{t1data1:"t1-2row-data1",t1data2:"t1-2row-data2",t1data3:"t1-2row-data3",t1data4:"t1-2row-data4"},{t1data1:"t1-3row-data1",t1data2:"t1-3row-data2",t1data3:"t1-3row-data3",t1data4:"t1-3row-data4"}],t1total1:"t1total1-data",t1total2:"t1total2-data",t1total3:"t1total3-data"}),docX["tableComplex2Example.docx"].applyTags(),e=docX["tableComplex2Example.docx"].getFullText(),expect(e).toBe("TABLE1COLUMN1COLUMN2COLUMN3COLUMN4t1-1row-data1t1-1row-data2t1-1row-data3t1-1row-data4t1-2row-data1t1-2row-data2t1-2row-data3t1-2row-data4t1-3row-data1t1-3row-data2t1-3row-data3t1-3row-data4TOTALt1total1-datat1total2-datat1total3-data")}),it("should work with more complex table",function(){var e;return docX["tableComplexExample.docx"].setTags({table2:[{t2data1:"t2-1row-data1",t2data2:"t2-1row-data2",t2data3:"t2-1row-data3",t2data4:"t2-1row-data4"},{t2data1:"t2-2row-data1",t2data2:"t2-2row-data2",t2data3:"t2-2row-data3",t2data4:"t2-2row-data4"}],t1total1:"t1total1-data",t1total2:"t1total2-data",t1total3:"t1total3-data",t2total1:"t2total1-data",t2total2:"t2total2-data",t2total3:"t2total3-data"}),docX["tableComplexExample.docx"].applyTags(),e=docX["tableComplexExample.docx"].getFullText(),expect(e).toBe("TABLE1COLUMN1COLUMN2COLUMN3COLUMN4TOTALt1total1-datat1total2-datat1total3-dataTABLE2COLUMN1COLUMN2COLUMN3COLUMN4t2-1row-data1t2-1row-data2t2-1row-data3t2-1row-data4t2-2row-data1t2-2row-data2t2-2row-data3t2-2row-data4TOTALt2total1-datat2total2-datat2total3-data")}),it("should work with two tables",function(){var e;return docX["tableComplex3Example.docx"].setTags({table1:[{t1data1:"t1-1row-data1",t1data2:"t1-1row-data2",t1data3:"t1-1row-data3",t1data4:"t1-1row-data4"},{t1data1:"t1-2row-data1",t1data2:"t1-2row-data2",t1data3:"t1-2row-data3",t1data4:"t1-2row-data4"},{t1data1:"t1-3row-data1",t1data2:"t1-3row-data2",t1data3:"t1-3row-data3",t1data4:"t1-3row-data4"}],table2:[{t2data1:"t2-1row-data1",t2data2:"t2-1row-data2",t2data3:"t2-1row-data3",t2data4:"t2-1row-data4"},{t2data1:"t2-2row-data1",t2data2:"t2-2row-data2",t2data3:"t2-2row-data3",t2data4:"t2-2row-data4"}],t1total1:"t1total1-data",t1total2:"t1total2-data",t1total3:"t1total3-data",t2total1:"t2total1-data",t2total2:"t2total2-data",t2total3:"t2total3-data"}),docX["tableComplex3Example.docx"].applyTags(),e=docX["tableComplex3Example.docx"].getFullText(),expect(e).toBe("TABLE1COLUMN1COLUMN2COLUMN3COLUMN4t1-1row-data1t1-1row-data2t1-1row-data3t1-1row-data4t1-2row-data1t1-2row-data2t1-2row-data3t1-2row-data4t1-3row-data1t1-3row-data2t1-3row-data3t1-3row-data4TOTALt1total1-datat1total2-datat1total3-dataTABLE2COLUMN1COLUMN2COLUMN3COLUMN4t2-1row-data1t2-1row-data2t2-1row-data3t2-1row-data4t2-2row-data1t2-2row-data2t2-2row-data3t2-2row-data4TOTALt2total1-datat2total2-datat2total3-data")})}),describe("Raw Xml Insertion",function(){return docX["xmlInsertionExample.docx"].setTags({complexXml:'<w:p w:rsidR="00612058" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:color w:val="FF0000"/></w:rPr></w:pPr><w:r><w:rPr><w:color w:val="FF0000"/></w:rPr><w:t>My custom XML</w:t></w:r></w:p><w:tbl><w:tblPr><w:tblStyle w:val="Grilledutableau"/><w:tblW w:w="0" w:type="auto"/><w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/></w:tblPr><w:tblGrid><w:gridCol w:w="2952"/><w:gridCol w:w="2952"/><w:gridCol w:w="2952"/></w:tblGrid><w:tr w:rsidR="00EA4B08" w:rsidTr="00EA4B08"><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="DDD9C3" w:themeFill="background2" w:themeFillShade="E6"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRPr="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:b/><w:color w:val="000000" w:themeColor="text1"/></w:rPr></w:pPr><w:r><w:rPr><w:b/><w:color w:val="000000" w:themeColor="text1"/></w:rPr><w:t>Test</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="DDD9C3" w:themeFill="background2" w:themeFillShade="E6"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRPr="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:b/><w:color w:val="FF0000"/></w:rPr></w:pPr><w:r><w:rPr><w:b/><w:color w:val="FF0000"/></w:rPr><w:t>Xml</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="DDD9C3" w:themeFill="background2" w:themeFillShade="E6"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:color w:val="FF0000"/></w:rPr></w:pPr><w:r><w:rPr><w:color w:val="FF0000"/></w:rPr><w:t>Generated</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EA4B08" w:rsidTr="00EA4B08"><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="C6D9F1" w:themeFill="text2" w:themeFillTint="33"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRPr="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:color w:val="000000" w:themeColor="text1"/><w:u w:val="single"/></w:rPr></w:pPr><w:r w:rsidRPr="00EA4B08"><w:rPr><w:color w:val="000000" w:themeColor="text1"/><w:u w:val="single"/></w:rPr><w:t>Underline</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="C6D9F1" w:themeFill="text2" w:themeFillTint="33"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:color w:val="FF0000"/></w:rPr></w:pPr><w:r w:rsidRPr="00EA4B08"><w:rPr><w:color w:val="FF0000"/><w:highlight w:val="yellow"/></w:rPr><w:t>Highlighting</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="C6D9F1" w:themeFill="text2" w:themeFillTint="33"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRPr="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:rFonts w:ascii="Bauhaus 93" w:hAnsi="Bauhaus 93"/><w:color w:val="FF0000"/></w:rPr></w:pPr><w:r w:rsidRPr="00EA4B08"><w:rPr><w:rFonts w:ascii="Bauhaus 93" w:hAnsi="Bauhaus 93"/><w:color w:val="FF0000"/></w:rPr><w:t>Font</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EA4B08" w:rsidTr="00EA4B08"><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="F2DBDB" w:themeFill="accent2" w:themeFillTint="33"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00EA4B08"><w:pPr><w:jc w:val="center"/><w:rPr><w:color w:val="FF0000"/></w:rPr></w:pPr><w:r><w:rPr><w:color w:val="FF0000"/></w:rPr><w:t>Centering</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="F2DBDB" w:themeFill="accent2" w:themeFillTint="33"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRPr="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:i/><w:color w:val="FF0000"/></w:rPr></w:pPr><w:r w:rsidRPr="00EA4B08"><w:rPr><w:i/><w:color w:val="FF0000"/></w:rPr><w:t>Italic</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="F2DBDB" w:themeFill="accent2" w:themeFillTint="33"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:color w:val="FF0000"/></w:rPr></w:pPr></w:p></w:tc></w:tr><w:tr w:rsidR="00EA4B08" w:rsidTr="00EA4B08"><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="E5DFEC" w:themeFill="accent4" w:themeFillTint="33"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:color w:val="FF0000"/></w:rPr></w:pPr></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="E5DFEC" w:themeFill="accent4" w:themeFillTint="33"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:color w:val="FF0000"/></w:rPr></w:pPr></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="E5DFEC" w:themeFill="accent4" w:themeFillTint="33"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:color w:val="FF0000"/></w:rPr></w:pPr></w:p></w:tc></w:tr><w:tr w:rsidR="00EA4B08" w:rsidTr="00EA4B08"><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="FDE9D9" w:themeFill="accent6" w:themeFillTint="33"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:color w:val="FF0000"/></w:rPr></w:pPr></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="FDE9D9" w:themeFill="accent6" w:themeFillTint="33"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:color w:val="FF0000"/></w:rPr></w:pPr></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="2952" w:type="dxa"/><w:shd w:val="clear" w:color="auto" w:fill="FDE9D9" w:themeFill="accent6" w:themeFillTint="33"/></w:tcPr><w:p w:rsidR="00EA4B08" w:rsidRDefault="00EA4B08" w:rsidP="00612058"><w:pPr><w:rPr><w:color w:val="FF0000"/></w:rPr></w:pPr></w:p></w:tc></w:tr></w:tbl>'}),docX["xmlInsertionExample.docx"].applyTags(),it("should work with simple example",function(){var e,t;t=[];for(e in docX["xmlInsertionExample.docx"].zip.files)expect(docX["xmlInsertionExample.docx"].zip.files[e].options.date).not.toBe(docX["xmlInsertionExpected.docx"].zip.files[e].options.date),expect(docX["xmlInsertionExample.docx"].zip.files[e].name).toBe(docX["xmlInsertionExpected.docx"].zip.files[e].name),expect(docX["xmlInsertionExample.docx"].zip.files[e].options.dir).toBe(docX["xmlInsertionExpected.docx"].zip.files[e].options.dir),expect(docX["xmlInsertionExample.docx"].zip.files[e].asText().length).toBe(docX["xmlInsertionExpected.docx"].zip.files[e].asText().length),t.push(expect(docX["xmlInsertionExample.docx"].zip.files[e].asText()).toBe(docX["xmlInsertionExpected.docx"].zip.files[e].asText()));return t}),it("should work even when tags are after the xml",function(){return docX["xmlInsertionComplexExample.docx"].setTags({}),docX["xmlInsertionComplexExample.docx"].applyTags()})}),describe("SubContent",function(){var e;return e=new SubContent("start<w:t>text</w:t>end"),e.start=10,e.end=14,e.refreshText(),it("should get the text inside the tags correctly",function(){return expect(e.text).toBe("text")}),it("should get the text expanded to the outer xml",function(){return e.getOuterXml("w:t"),expect(e.text).toBe("<w:t>text</w:t>")}),it("should replace the inner text",function(){return e.replace("<w:table>Sample Table</w:table>"),expect(e.fullText).toBe("start<w:table>Sample Table</w:table>end"),expect(e.text).toBe("<w:table>Sample Table</w:table>")})})}).call(this);